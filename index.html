<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº”åéŸ³å†’éšª Ver 3.3.0</title>
    <style>
        :root {
            --pink: #FFD1DC;
            --blue: #BFEAF2;
            --yellow: #FFF4BD;
            --text: #5d4037;
            --white: #ffffff;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            font-family: "PingFang TC", "Microsoft JhengHei", sans-serif;
            color: var(--text);
        }

        body {
            margin: 0; padding: 0;
            background-color: #FFFBFA;
            background-image: radial-gradient(var(--pink) 1px, transparent 1px);
            background-size: 30px 30px;
            display: flex; flex-direction: column; align-items: center;
            height: 100vh; overflow: hidden;
        }

        /* å°è¦½åˆ— */
        .nav-header {
            width: 100%; background: white; padding: 10px 15px;
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 3px solid var(--pink);
            z-index: 100;
        }

        .btn-home {
            text-decoration: none; background: var(--yellow); padding: 8px 15px;
            border-radius: 20px; font-weight: bold; font-size: 0.9rem;
            border: 2px solid var(--text);
        }

        /* æ¨¡å¼åˆ‡æ› */
        .mode-selector {
            display: flex; gap: 10px; margin: 15px 0;
        }

        .mode-btn {
            padding: 8px 20px; border-radius: 20px; border: 2px solid var(--pink);
            background: white; font-weight: bold; cursor: pointer;
        }

        .mode-btn.active { background: var(--pink); color: white; }

        /* è¡Œé¸æ“‡å™¨ */
        .row-selector {
            display: flex; gap: 8px; overflow-x: auto; width: 100%; padding: 10px;
            scrollbar-width: none;
        }
        .row-btn {
            flex-shrink: 0; padding: 5px 15px; background: white;
            border: 2px solid var(--blue); border-radius: 15px; font-weight: bold;
        }
        .row-btn.active { background: var(--blue); }

        /* éŠæˆ²èˆ‡å­¸ç¿’å€åŸŸ */
        #main-stage {
            flex-grow: 1; width: 100%; position: relative;
            display: flex; flex-direction: column; align-items: center;
        }

        /* å­¸ç¿’æ¨¡å¼å¡ç‰‡ */
        .study-grid {
            display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
            gap: 15px; padding: 20px; width: 100%; max-width: 400px;
        }

        .study-card {
            background: white; border: 4px solid var(--yellow); border-radius: 20px;
            padding: 20px 10px; text-align: center;
            box-shadow: 0 5px 0 var(--yellow); cursor: pointer;
            transition: transform 0.1s;
        }
        .study-card:active { transform: scale(0.95); }
        .study-card .kana { font-size: 2rem; font-weight: bold; display: block; }
        .study-card .roma { font-size: 0.9rem; color: #aaa; }

        /* æ¸¬é©—æ¨¡å¼é¡Œç›® */
        .quiz-box {
            background: white; border: 5px solid var(--pink); border-radius: 25px;
            padding: 20px 40px; margin: 20px 0; text-align: center;
        }
        #target-kana { font-size: 3.5rem; font-weight: bold; }

        .bubble {
            position: absolute; border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.5rem; font-weight: bold; color: white;
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.1);
            border: 2px solid white; cursor: pointer;
        }

        .version-tag { position: fixed; bottom: 8px; right: 12px; font-size: 11px; opacity: 0.5; }
    </style>
</head>
<body>

    <div class="nav-header">
        <a href="https://liliancir0125.github.io/Rumi_Study_Hall/" class="btn-home">ğŸ  å›å¤§å»³</a>
        <div style="font-weight: bold; color: var(--pink);">å¾—åˆ†: <span id="score">0</span></div>
    </div>

    <div class="mode-selector">
        <button class="mode-btn active" id="btn-study" onclick="switchMode('study')">ğŸ“– ç·´ç¿’æ¨¡å¼</button>
        <button class="mode-btn" id="btn-quiz" onclick="switchMode('quiz')">ğŸ® æŒ‘æˆ°æ¨¡å¼</button>
    </div>

    <div class="row-selector" id="row-btns">
        </div>

    <div id="main-stage">
        </div>

    <div class="version-tag">Ver. 3.3.0</div>

    <script>
        const data = {
            'ã‚': [{k:'ã‚', r:'a'},{k:'ã„', r:'i'},{k:'ã†', r:'u'},{k:'ãˆ', r:'e'},{k:'ãŠ', r:'o'}],
            'ã‹': [{k:'ã‹', r:'ka'},{k:'ã', r:'ki'},{k:'ã', r:'ku'},{k:'ã‘', r:'ke'},{k:'ã“', r:'ko'}],
            'ã•': [{k:'ã•', r:'sa'},{k:'ã—', r:'shi'},{k:'ã™', r:'su'},{k:'ã›', r:'se'},{k:'ã', r:'so'}],
            'ãŸ': [{k:'ãŸ', r:'ta'},{k:'ã¡', r:'chi'},{k:'ã¤', r:'tsu'},{k:'ã¦', r:'te'},{k:'ã¨', r:'to'}]
        };
        
        let currentMode = 'study', currentRow = 'ã‚', score = 0, target = {};
        const colors = ['#FFD1DC', '#BFEAF2', '#FFF4BD', '#FFDFD3', '#D0F0C0'];

        function speak(t) {
            const ut = new SpeechSynthesisUtterance(t);
            ut.lang = 'ja-JP'; ut.rate = 0.8;
            window.speechSynthesis.speak(ut);
        }

        function switchMode(m) {
            currentMode = m;
            document.getElementById('btn-study').classList.toggle('active', m==='study');
            document.getElementById('btn-quiz').classList.toggle('active', m==='quiz');
            renderStage();
        }

        function renderStage() {
            const stage = document.getElementById('main-stage');
            stage.innerHTML = '';
            const list = data[currentRow];

            if(currentMode === 'study') {
                const grid = document.createElement('div');
                grid.className = 'study-grid';
                list.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'study-card';
                    card.innerHTML = `<span class="kana">${item.k}</span><span class="roma">${item.r}</span>`;
                    card.onclick = () => speak(item.k);
                    grid.appendChild(card);
                });
                stage.appendChild(grid);
            } else {
                const box = document.createElement('div');
                box.className = 'quiz-box';
                box.innerHTML = `<div style="font-size:0.8rem">æ‰¾å‡ºé€™å€‹éŸ³</div><div id="target-kana">?</div>`;
                stage.appendChild(box);
                newQuiz();
                list.forEach((item, idx) => {
                    const b = document.createElement('div');
                    b.className = 'bubble'; b.innerText = item.r;
                    b.style.width = '70px'; b.style.height = '70px';
                    b.style.backgroundColor = colors[idx % colors.length];
                    b.style.left = Math.random() * (window.innerWidth - 80) + 'px';
                    b.style.top = (Math.random() * 200 + 150) + 'px';
                    b.onclick = () => checkAnswer(item.r);
                    stage.appendChild(b);
                });
            }
        }

        function newQuiz() {
            const list = data[currentRow];
            target = list[Math.floor(Math.random()*list.length)];
            document.getElementById('target-kana').innerText = target.k;
            speak(target.k);
        }

        function checkAnswer(r) {
            if(r === target.r) {
                score += 10; document.getElementById('score').innerText = score;
                newQuiz();
            } else { alert("ä¸å°å–”ï¼"); }
        }

        function init() {
            const rb = document.getElementById('row-btns');
            Object.keys(data).forEach(key => {
                const b = document.createElement('button');
                b.className = 'row-btn' + (key === currentRow ? ' active' : '');
                b.innerText = key + ' è¡Œ';
                b.onclick = () => {
                    currentRow = key;
                    Array.from(rb.children).forEach(c => c.classList.remove('active'));
                    b.classList.add('active');
                    renderStage();
                };
                rb.appendChild(b);
            });
            renderStage();
        }
        window.onload = init;
    </script>
</body>
</html>
